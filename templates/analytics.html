{% extends "layout.html" %}

{% block title %}Analytics - AirAware{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/analytics.css') }}">
{% endblock %}

{% block body %}
<div class="container">
    <h1 class="mt-4 mb-4">Fan Analytics</h1>
    
    <div class="analytics-cards">
        <div class="stats-card">
            <h3>Total Runtime</h3>
            <div class="stat-value" id="totalRuntime">{{ analytics.totalRuntime }}h</div>
        </div>
        <div class="stats-card">
            <h3>Active Fans</h3>
            <div class="stat-value" id="activeFans">{{ analytics.activeFans }}</div>
        </div>
        <div class="stats-card">
            <h3>Efficiency</h3>
            <div class="stat-value" id="efficiency">{{ analytics.efficiency }}%</div>
        </div>
    </div>

    <div class="table-responsive mt-4">
        <table class="table">
            <thead>
                <tr>
                    <th>Room</th>
                    <th>Status</th>
                    <th>Runtime Today</th>
                    <th>Last Active</th>
                    <th>COâ‚‚ Reduced</th>
                </tr>
            </thead>
            <tbody id="fanUsageTable">
                {% for fan in analytics.fans %}
                <tr>
                    <td>{{ fan.room }}</td>
                    <td><span class="status-badge {% if fan.status == 'ON' %}status-active{% else %}status-inactive{% endif %}">{{ fan.status }}</span></td>
                    <td>{{ fan.runtimeToday }}h</td>
                    <td>{{ fan.lastActive }}</td>
                    <td>{{ fan.co2Reduced }} ppm</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Add initial data for JavaScript -->
<script type="application/json" id="initialData">
{{ analytics | tojson | safe }}
</script>

<script src="{{ url_for('static', filename='js/analytics.js') }}"></script>
{% endblock %}