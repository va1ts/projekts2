{% extends 'layout.html' %}

{% block title %}Dashboard{% endblock %}

{% block body %}
  <div class="container">
    <h1>Dashboard</h1>

    <!-- Assign Fan Section -->
    <h2>Assign Fan</h2>
    <form method="post">
      <div class="form-group">
        <label for="room">Room</label>
        <select class="form-control" id="room" name="room">
          {% for room in rooms %}
            <option value="{{ room['roomGroupName'] }}">{{ room['roomGroupName'] }}</option>
          {% endfor %}
        </select>
      </div>
      <button type="submit" class="btn btn-primary" name="assign_fan">Assign Fan</button>
    </form>

<!-- Fan Assignments Section -->
<h2 class="mt-4">Fan Assignments</h2>
<ul class="list-group mt-3">
  {% for fan in fan_assignments %}
    <li class="list-group-item">
      <p>
        <strong>Room:</strong> 
        <!-- Clickable link to view the COâ‚‚ graph for this room -->
        <a href="{{ url_for('room_graph', room=fan['room']) }}">{{ fan['room'] }}</a>
      </p>
      <p><strong>Status:</strong> {{ fan['status'] }}</p>
      {% if fan.get('message') %}
        <p><strong>Message:</strong> {{ fan['message'] }}</p>
      {% endif %}
      <form action="{{ url_for('dashboard') }}" method="post" class="mt-2">
        <input type="hidden" name="room" value="{{ fan['room'] }}">
        <button type="submit" name="fan_control" value="on" class="btn btn-success">Turn On</button>
        <button type="submit" name="fan_control" value="off" class="btn btn-danger">Turn Off</button>
      </form>
    </li>
  {% endfor %}
</ul>
</div>
{% endblock %}
