{% extends 'layout.html' %}

{% block title %}Register{% endblock %}

{% block body %}
  <div class="d-flex justify-content-center align-items-center min-vh-100">
    <div class="card p-4 shadow-lg" style="width: 400px;">
      <h1 class="text-center mb-4">Registeration</h1>
  <h1>Register</h1>
  
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <form method="post">
    <div class="form-group">
      <label for="username">Username</label>
      <input type="text" class="form-control" id="username" name="username" required>
      <small id="usernameHelp" class="form-text text-muted">Choose a unique username.</small>
    </div>
    <div class="form-group">
      <label for="password">Password</label>
      <input type="password" class="form-control" id="password" name="password" required>
      <small id="passwordHelp" class="form-text text-muted">Must be at least 8 characters and include an uppercase letter, lowercase letter, number, and special character.</small>
        
      </small>
      <div id="passwordStrength" class="mt-2"></div>
    </div>
    <button type="submit" class="btn btn-primary w-100">Register</button>
  </form>

  <!-- Password Strength Script -->
  <script>
    const passwordInput = document.getElementById('password');
    const strengthDisplay = document.getElementById('passwordStrength');

    passwordInput.addEventListener('input', () => {
      const password = passwordInput.value;
      const strongPassword = new RegExp('^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$');

      if (strongPassword.test(password)) {
        strengthDisplay.innerHTML = '<div class=\"alert alert-success\">Strong password ✔️</div>';
      } else {
        strengthDisplay.innerHTML = '<div class=\"alert alert-danger\">Weak password ❌</div>';
      }
    });
  </script>
{% endblock %}